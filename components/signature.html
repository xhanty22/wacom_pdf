<div>
  <div class="options-container">
    <div class="options-left">
      <a @click="$root.back()" class="btn btn-primary" title="Regresar">
        <img class="icon-ctl" src="assets/img/back.png" alt="Regresar">
      </a>
    </div>

    <div class="options-center">
      <a @click="$root.addZoom()" class="btn btn-primary" title="Aumentar Zoom">
        <img class="icon-ctl" src="assets/img/add.png" alt="Aumentar Zoom">
      </a>
      <a @click="$root.lessZoom()" class="btn btn-primary" title="Disminuir Zoom">
        <img class="icon-ctl" src="assets/img/less.png" alt="Disminuir Zoom">
      </a>
    </div>

    <div class="options-right-spacer"></div>
  </div>
  <div class="content">

    <div class="content-page">
      <div class="page-signature">
        <div class="viewer">
          <div class="viewer-x" tabindex="0">
            <div class="viewer-scale" :style="$root.viewerStyle">
              <div class="files" v-for="(file, index) in $root.selected" :key="file.id || index">
                <div class="content-document" v-html="file.html"></div>

                <div class="fila-decision" v-if="file.requireDecision && file.decisionScope !== 'group'">
                  <div class="group-buttons">
                    <button type="button" class="btn-decision" :class="{ 
          aprobar: $root.decisionTmp[file.id] === true,
          active:    $root.decisionTmp[file.id] === false 
        }" @click="$root.setDecision(file.id, true)">
                      <img src="assets/img/approved.png" alt="Icono">Acepto
                    </button>

                    <button type="button" class="btn-decision" :class="{
          rechazar: $root.decisionTmp[file.id] === false,
          active:    $root.decisionTmp[file.id] === true
        }" @click="$root.setDecision(file.id, false)">
                      <img src="assets/img/cancel.png" alt="Icono">No acepto
                    </button>
                  </div>
                </div>

                <hr>
              </div>

              <!-- Decisión única para el grupo seleccionado -->
              <div class="fila-decision" v-if="$root.hasGroupDecision">
                <div class="group-buttons">
                  <button type="button" class="btn-decision aprobar"
                    :class="{ active: $root.groupDecision === true, dim: $root.groupDecision === false }"
                    @click="$root.groupDecision = true">
                    <img src="assets/img/approved.png" alt="Icono">Acepto
                  </button>

                  <button type="button" class="btn-decision rechazar"
                    :class="{ active: $root.groupDecision === false, dim: $root.groupDecision === true }"
                    @click="$root.groupDecision = false">
                    <img src="assets/img/cancel.png" alt="Icono">No acepto
                  </button>
                </div>
              </div>

              <!-- Firma única (sin responsable) -->
              <div class="div-signature" v-if="!$root.hasResponsable">
                <div class="signature-single-container">
                  <div class="signature-single-canvas">
                    <canvas id="draw-canvas" height="230" width="500" class="signature-pad" @pointerup="$root.validateCanvas"></canvas>
                    <button class="clear-button" :class="{ signed: $root.canvaIsNull === false, empty: $root.canvaIsNull === true }" @click="$root.clearCanvas">
                      <img src="assets/img/clear.png" alt="Icono"> Limpiar</button>
                  </div>
                </div>
                <div class="signature-save-row">
                  <button class="signature-button" @click="$root.save">
                    <img src="assets/img/save.png" alt="Icono"> Guardar</button>
                </div>
              </div>

              <!-- Firmas dobles (con responsable) -->
              <div class="div-signature-dual" v-if="$root.hasResponsable">
                <div class="signature-dual-container">
                  <div class="signature-column">
                    <canvas id="draw-canvas" height="230" width="500" class="signature-pad" @pointerup="$root.validateCanvas"></canvas>
                    <div class="signature-info">
                      <p><strong>{{ $root.pacienteData.nombreCompleto }}</strong></p>
                      <p>{{ $root.pacienteData.desTIdentificacion }} - {{ $root.pacienteData.docIdentidad }}</p>
                      <p><strong>Paciente</strong></p>
                    </div>
                    <button class="clear-button" :class="{ signed: $root.canvaIsNull === false, empty: $root.canvaIsNull === true }" @click="$root.clearCanvas">
                      <img src="assets/img/clear.png" alt="Icono"> Limpiar</button>
                  </div>
                  <div class="signature-column">
                    <canvas id="draw-canvas-responsable" height="230" width="500" class="signature-pad" @pointerup="$root.validateCanvasResponsable"></canvas>
                    <div class="signature-info">
                      <p><strong>{{ $root.responsableData?.nombreCompleto || '' }}</strong></p>
                      <p>{{ $root.responsableData.desTIdentificacionResponsable }} - {{ $root.responsableData?.documento || '' }}</p>
                      <p><strong>Responsable</strong></p>
                    </div>
                    <button class="clear-button" :class="{ signed: $root.canvaResponsableIsNull === false, empty: $root.canvaResponsableIsNull === true }" @click="$root.clearCanvasResponsable">
                      <img src="assets/img/clear.png" alt="Icono"> Limpiar</button>
                  </div>
                </div>
                <div class="signature-save-row">
                  <button class="signature-button" @click="$root.save">
                    <img src="assets/img/save.png" alt="Icono"> Guardar</button>
                </div>
              </div>
              <div class="scroll-spacer" aria-hidden="true"></div>
            </div>
          </div>

        </div>

      </div>
    </div>

    <div class="sfab-wrap">
      <a @click="$root.scrollStep(-1)" class="btn btn-primary sfab-up" title="Subur">
        <img class="icon-ctl" src="assets/img/back.png">
      </a>
      <a @click="$root.scrollStep(1)" class="btn btn-primary sfab-down" title="Bajar">
        <img class="icon-ctl" src="assets/img/back.png">
      </a>
    </div>
  </div>
</div>